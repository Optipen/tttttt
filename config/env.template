# ============================================
# Configuration Wallet Monitor Bot
# ============================================
# Copiez ce fichier vers .env et ajustez les valeurs selon vos besoins
# ATTENTION: Ne commitez jamais .env avec des clés API réelles !

# ============================================
# CONFIGURATION GÉNÉRALE
# ============================================

# Active ou désactive le copy-trader (⚠️ désactivez-le pour mode DaaS)
COPY_TRADER_ENABLED=false

# Mode DaaS activé (true/false/1/0)
# Si true: Mode Data-as-a-Service activé (API REST + webhooks)
DAAS_MODE=true

# ============================================
# ENDPOINTS RPC (Solana)
# ============================================
# Liste des endpoints RPC (séparés par des virgules)
# Mettez QuickNode ou Helius en premier pour la priorité
# Format: endpoint1,endpoint2,endpoint3
RPC_ENDPOINTS=https://api.mainnet-beta.solana.com

# Mode RPC (live | fixtures)
# - live: Utilise les vrais endpoints RPC
# - fixtures: Utilise les fichiers JSON locaux pour tests
RPC_MODE=live

# Dossier pour les fixtures (si RPC_MODE=fixtures)
FIXTURES_DIR=tests/fixtures

# Timeout pour les appels RPC (en secondes)
RPC_TIMEOUT_SEC=2.5

# Nombre maximum de tentatives pour un appel RPC en cas d'échec
RPC_MAX_RETRIES=3

# Circuit breaker RPC (nombre d'échecs avant désactivation temporaire)
RPC_CIRCUIT_BREAKER_FAILURES=3

# Pause circuit breaker (en secondes)
RPC_CIRCUIT_BREAKER_PAUSE_SEC=5.0

# Jitter pour retry RPC (base)
RPC_RETRY_JITTER_BASE=0.5

# Jitter pour retry RPC (max)
RPC_RETRY_JITTER_MAX=0.2

# ============================================
# PARAMÈTRES DE SURVEILLANCE
# ============================================
# Seuil de profit minimum pour générer une alerte (en SOL)
# Réduire pour plus d'alertes (ex: 0.2, 0.1)
# Pour tester le format: 0.1
# Pour production: 1.0-2.0
PROFIT_ALERT_THRESHOLD=0.3

# Nombre de signatures à récupérer par wallet (historique)
TX_LOOKBACK=50

# Intervalle entre chaque scan de watchlist (en secondes)
# Réduire pour scans plus fréquents (ex: 20, 30)
# Recommandé: 30-60s
TX_REFRESH_SECONDS=30

# ============================================
# RAPPORTS PÉRIODIQUES
# ============================================
# Intervalle entre deux rafraîchissements du rapport/dashboards (en secondes)
REPORT_REFRESH_SECONDS=1800

# Délai avant l'envoi du premier rapport détaillé (0 = immédiat)
REPORT_INITIAL_DELAY_SECONDS=0

# Intervalle minimum entre deux rapports détaillés envoyés sur Discord (en secondes)
# Minimum recommandé: 600 (10 min) pour éviter le spam
REPORT_MIN_INTERVAL_SECONDS=600

# Intervalle entre deux messages heartbeat Discord (0 = désactivé)
# 900 = 15 minutes, 0 = désactivé
HEARTBEAT_INTERVAL_SECONDS=900

# ============================================
# FILTRES DE WALLETS
# ============================================
# Gain net minimum requis pour qu'un wallet soit surveillé (en SOL)
GAIN_FILTER=0.5

# Taux de réussite minimum requis pour qu'un wallet soit surveillé (%)
WIN_RATE_FILTER=80.0

# ============================================
# WATCHLIST
# ============================================
# Taille maximum de la watchlist (nombre de wallets surveillés)
WATCHLIST_MAX_SIZE=100

# TTL de la watchlist en secondes (3600 = 1h)
WATCHLIST_TTL_SEC=3600

# ============================================
# AJOUT AUTOMATIQUE DE WALLETS
# ============================================
# Gain minimum pour déclencher l'ajout automatique d'un nouveau wallet (en SOL)
NEW_WALLET_GAIN=7.0

# Nombre minimum de transactions requises pour ajouter un nouveau wallet
NEW_WALLET_MIN_TRX=12

# ============================================
# ALERTES
# ============================================
# Cooldown entre deux alertes pour le même wallet (en secondes)
# 300 = 5 minutes, 600 = 10 minutes
ALERT_COOLDOWN_SEC=300

# Taille des batches d'alertes (nombre d'alertes par batch)
ALERT_BATCH_SIZE=10

# TTL de l'état (signatures vues) en secondes (3600 = 1h)
STATE_TTL_SECONDS=3600

# Nombre maximum de signatures en cache
MAX_SEEN_SIGNATURES=50000

# Mode DRY_RUN (true/false/1/0)
# Si true: Les alertes sont détectées mais pas envoyées (sauf notifications système)
# Si false: Toutes les notifications sont envoyées (Discord, etc.)
# DÉSACTIVEZ pour recevoir les notifications Discord
DRY_RUN=false

# Afficher le prompt upgrade dans Discord (true/false/1/0)
INCLUDE_PAYWALL_PROMPT=true

# Webhook Discord pour les alertes enrichies
# Format: https://discord.com/api/webhooks/XXX/YYY
# Laisser vide pour désactiver Discord
DISCORD_WEBHOOK=

# ============================================
# PERFORMANCE & ASYNC
# ============================================
# Nombre maximum de wallets scannés en parallèle (async)
# 5-10: Suffisant pour 6-20 wallets
# 20+: Pour watchlists importantes (>50 wallets)
MAX_CONCURRENCY=10

# ============================================
# OBSERVABILITÉ (Prometheus)
# ============================================
# Port pour exposer les métriques Prometheus
PROMETHEUS_PORT=8000

# Tolérance balance en pourcentage
BALANCE_TOLERANCE_PCT=10.0

# Buckets pour durée des alertes (secondes)
ALERT_DURATION_BUCKETS=0.5,1,2,5,10

# ============================================
# PRIX DES TOKENS (Oracles)
# ============================================
# Clé API Birdeye pour fallback si Jupiter échoue
# Laisser vide si pas disponible (Jupiter sera utilisé en priorité)
BIRDEYE_API_KEY=

# ============================================
# LOGGING
# ============================================
# Niveau de log (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Indentation JSON pour les logs (0 = compact)
LOG_JSON_INDENT=0

# Taille maximum des logs en bytes (10MB par défaut)
LOG_MAX_BYTES=10000000

# ============================================
# API & BILLING (DaaS)
# ============================================
# Port pour le serveur API REST
API_PORT=8002

# Host pour le serveur API REST
API_HOST=0.0.0.0

# Rate limits par tier (appels/jour)
RATE_LIMIT_FREE=10
RATE_LIMIT_PRO=1000
RATE_LIMIT_ELITE=10000

# Clé secrète Stripe (pour billing réel)
STRIPE_SECRET_KEY=

# Secret webhook Stripe
STRIPE_WEBHOOK_SECRET=

# Activer fake checkout pour tests (MVP)
FAKE_CHECKOUT_ENABLED=true

# ============================================
# DEBUG / TEST
# ============================================
# Activer l'alerte de test au démarrage (true/false/1/0)
# Utile pour tester le format des messages Discord
DEBUG_FORCE_ALERT=false

# Wallet de test pour DEBUG_FORCE_ALERT
DEBUG_FORCE_ALERT_WALLET=TEST_WALLET_FORCED

# Profit de test pour DEBUG_FORCE_ALERT (en SOL)
DEBUG_FORCE_ALERT_PROFIT=0.7

# ============================================
# NOTES IMPORTANTES
# ============================================
# 1. QuickNode ou Helius : mettez votre endpoint en PREMIER dans RPC_ENDPOINTS
#    pour de meilleures performances et éviter le rate limiting.
#
# 2. PROFIT_ALERT_THRESHOLD :
#    - 0.1-0.3 SOL → Mode test/staging (plus d'alertes)
#    - 1.0-2.0 SOL → Mode production (alertes filtrées)
#
# 3. TX_REFRESH_SECONDS :
#    - 20-30s → Scans fréquents (plus de détection, plus de charge)
#    - 60s → Équilibre recommandé en production
#
# 4. MAX_CONCURRENCY :
#    - 5-10 → Suffisant pour 6-20 wallets
#    - 20+ → Pour gros watchlists (>50 wallets)
#
# 5. ALERT_COOLDOWN_SEC :
#    - 300s (5 min) → Anti-spam standard
#    - 600s (10 min) → Mode conservateur
#
# 6. REPORT_REFRESH_SECONDS :
#    - 300 (5 min) → Rapports très fréquents (test)
#    - 600 (10 min) → Bon équilibre visibilité/spam
#    - 1800 (30 min) → Production standard
#
# 7. HEARTBEAT_INTERVAL_SECONDS :
#    - 900 (15 min) → Heartbeat régulier
#    - 0 → Désactivé (pas de heartbeat)
#
# 8. Rotation des secrets :
#    - Changez DISCORD_WEBHOOK si exposé publiquement
#    - Changez BIRDEYE_API_KEY si exposé publiquement
#    - Regénérez vos endpoints RPC si besoin
#
# 9. Variables critiques à ne pas oublier :
#    - REPORT_INITIAL_DELAY_SECONDS (0 pour rapport immédiat)
#    - REPORT_MIN_INTERVAL_SECONDS (600 = 10 min minimum)
#    - WATCHLIST_MAX_SIZE (100 = recommandé)
#    - WATCHLIST_TTL_SEC (3600 = 1h)
#    - ALERT_BATCH_SIZE (10 = recommandé)
#    - STATE_TTL_SECONDS (3600 = 1h)
#    - MAX_SEEN_SIGNATURES (50000 = recommandé)
#    - DAAS_MODE (true si vous utilisez l'API)
#    - INCLUDE_PAYWALL_PROMPT (true pour afficher CTA upgrade)
